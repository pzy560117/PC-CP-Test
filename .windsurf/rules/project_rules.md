# AI代理开发规则 

## 核心规则

### 1. 项目理解规则
- **必须首先阅读**：在编写任何代码前，必须首先阅读 `memory-bank/` 下的所有文件
- **全局视角**：始终从项目整体角度思考，避免局部优化
- **需求导向**：所有开发必须以PRD文档中的需求为导向
- **迭代遵循**：严格按照 `implementation-plan.md` 中的迭代顺序进行开发

### 2. 代码规范规则
- **命名规范**：
  - 类名使用大驼峰命名法（如 `AppAutomator`）
  - 函数/方法使用小驼峰命名法（如 `clickButton`）
  - 变量使用小驼峰命名法，保持语义化
  - 常量使用全大写加下划线（如 `SEARCH_TIMEOUT`）
- **模块化原则**：
  - 每个功能模块应有自己独立的文件和类
  - 单一职责原则：每个类/函数只负责一个明确的功能
  - 低耦合高内聚：模块间依赖最小化，模块内功能紧密相关
- **代码注释**：
  - 为每个类添加功能描述注释
  - 为复杂方法和关键逻辑添加详细注释
  - 使用docstring格式为公共方法提供参数和返回值说明

### 3. 开发流程规则
- **分步实施**：严格按照 `implementation-plan.md` 中的步骤进行开发
- **测试先行**：每个功能开发完成后，立即编写并运行测试
- **进度更新**：每完成一个步骤，必须更新 `memory-bank/progress.md`
- **架构更新**：每完成一个主要功能，必须更新 `memory-bank/architecture.md`
- **代码提交**：每个步骤完成后通过Git提交代码，提交信息清晰明确

### 4. 错误处理规则
- **异常捕获**：所有可能失败的操作必须有try-except结构
- **自定义异常**：使用 `src/exception/` 中定义的异常类，避免直接抛出通用异常
- **错误日志**：所有异常必须记录到日志，包含足够的上下文信息
- **优雅降级**：在非关键功能失败时，系统应能继续运行或优雅退出

### 5. 性能优化规则
- **等待策略**：使用显式等待和隐式等待结合，避免硬编码等待时间
- **资源管理**：及时释放资源，避免内存泄漏和资源占用
- **网络请求**：实现请求缓存和重试机制，避免不必要的重复请求
- **数据结构**：选择适当的数据结构，优化数据处理效率

### 6. 安全规则
- **敏感信息**：不在日志中记录密码、令牌等敏感信息
- **API调用**：遵守API使用限制，添加适当的请求延迟
- **输入验证**：对所有外部输入进行验证和清洗
- **权限控制**：最小权限原则，只请求必要的权限

## 开发指导

### 1. 开发前准备
- 阅读所有 `memory-bank/` 文件，理解项目全貌
- 确认当前迭代和具体任务
- 检查相关依赖和环境是否就绪
- 规划实现思路和关键步骤

### 2. 开发过程中
- 先编写接口/类的基本结构，再实现具体功能
- 每个方法实现后立即进行单元测试
- 遇到问题时，首先检查是否违反了上述规则
- 定期运行代码检查工具，确保代码质量

### 3. 开发完成后
- 运行所有相关测试，确保功能正确
- 更新相关文档（进度、架构等）
- 进行代码审查，检查是否符合规范
- 提交代码前确保没有遗留的调试代码

## 回答格式要求

### 1. 计划说明
在回复开始时，首先简要说明你的计划：
```
我将按照以下步骤完成任务：
1. 步骤一：...
2. 步骤二：...
3. 步骤三：...
```

### 2. 代码展示
展示代码时，使用适当的代码块和语法高亮，并添加必要的注释说明。

### 3. 测试说明
提供测试方法和预期结果，确保代码可验证。

### 4. 注意事项
提醒用户需要注意的事项或可能的限制。

## 特殊场景处理

### 1. 需求不明确
当需求不明确时，应：
- 查阅PRD文档和相关设计文档
- 基于项目目标进行合理推断
- 明确指出假设条件，并请求确认

### 2. 技术难题
遇到技术难题时，应：
- 分析问题的根本原因
- 提出多种解决方案，比较优缺点
- 选择最适合项目需求的方案
- 记录决策过程和考虑因素

### 3. 紧急修复
对于紧急修复，可以：
- 暂时跳过某些非关键规则
- 快速实现最小可行解决方案
- 计划后续重构和完善
- 详细记录问题和解决方案

## 持续改进

### 1. 反馈收集
- 主动收集用户反馈
- 分析系统运行数据
- 识别常见问题和痛点

### 2. 规则更新
- 定期评估和更新开发规则
- 根据项目经验调整最佳实践
- 保持规则与项目发展阶段相适应

### 3. 知识分享
- 记录常见问题和解决方案
- 分享开发经验和技巧
- 建立项目知识库

---

**重要提醒**：这些规则旨在确保项目质量和开发效率，但在特殊情况下可以灵活处理。关键是要保持项目整体目标的一致性和代码质量的稳定性。