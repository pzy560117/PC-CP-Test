# 手动准备模式使用说明

## 概述

**手动准备模式**下，程序只负责核心的4个步骤：

✅ **程序负责**：
1. 连接到已运行的应用窗口
2. 点击"开始搜索"按钮
3. 等待搜索完成
4. 提取搜索结果
5. 对比开奖数据并记录

✋ **用户手动**：
1. 启动应用
2. 导航到"公式搜索"界面
3. 配置搜索参数（公式数量、数据期数、准确率等）

## 配置

在 `config/config.json` 中设置：

```json
{
    "target_app": {
        "skip_app_launch": true,
        "skip_navigation": true,
        "skip_parameter_config": true
    }
}
```

**说明**：
- ✅ `skip_app_launch: true` - 跳过启动应用，连接到已运行的窗口
- ✅ `skip_navigation: true` - 跳过自动导航
- ✅ `skip_parameter_config: true` - 跳过参数配置

**注意**：程序仍会连接窗口（用于图像识别），只是不会启动应用。

## 使用流程

### 1. 手动准备

**必须按顺序完成以下操作**：

#### a) 启动应用
```
双击运行：D:\software\CpzyrjCom.exe
等待应用完全加载（约30秒）
```

#### b) 导航到搜索界面
```
1. 点击"时时彩"标签
2. 等待界面加载（约2秒）
3. 点击"公式搜索"按钮
4. 等待搜索界面加载（约1.5秒）
```

#### c) 配置参数
```
- 搜索公式数量：100
- 数据期数：200
- 定码个数：5
- 计划周期：1
- 准确率：勾选 ≥ 57%
```

⚠️ **重要**：
- 配置完成后，**不要点击"开始搜索"**
- 确保"公式搜索"窗口处于激活状态
- 程序会自动识别窗口标题（支持"众赢国际版"或"公式搜索"）

### 2. 启动程序

```bash
python tests/test_full_flow.py
```

程序会提示你完成手动准备，准备好后按 **Enter** 键继续。

### 3. 程序自动执行

按 Enter 后，程序会：

```
⏩ 跳过应用启动（用户已手动启动应用）
步骤1: 连接到应用窗口...
  成功连接到窗口: 众赢国际版
步骤2: 初始化搜索组件...
步骤3: ⏩ 跳过导航（用户已手动导航）
步骤4: ⏩ 跳过参数配置（用户已手动配置）
步骤5: 🔍 执行搜索...
  ✓ 已点击: start_search_button.png
  等待搜索完成...
  搜索已完成
步骤6: 提取搜索结果...
  成功提取 5 条推荐号码
步骤7: 获取开奖数据并对比...
步骤8: 记录对比结果...
✅ 桌面自动化流程执行完成
```

### 4. 查看结果

程序会自动：
- 提取前5条推荐号码
- 获取最新开奖数据
- 对比命中情况
- 记录到 `data/results/comparison_history.jsonl`

## 优势

- ⚡ **更快** - 跳过自动化导航和配置，节省时间
- 🎯 **更准** - 手动配置参数更精确
- 🔧 **更灵活** - 可以随时调整参数
- 💪 **更稳定** - 避免图像识别失败

## 切换回完整模式

如果需要完全自动化，在 `config.json` 中设置：

```json
{
    "target_app": {
        "skip_navigation": false,
        "skip_parameter_config": false
    }
}
```

## 注意事项

1. ⏰ **时机** - 应用启动完成后再手动操作
2. 🎯 **准确** - 确保已经在"公式搜索"界面
3. ✅ **参数** - 配置完参数后不要点搜索，等程序自动点击
4. ⌛ **耐心** - 搜索过程可能需要几分钟

## 日志示例

```
步骤1: 连接到应用窗口...
步骤2: 初始化搜索组件...
步骤3: ⏩ 跳过导航（用户已手动导航到搜索界面）
步骤4: ⏩ 跳过参数配置（用户已手动配置参数）
步骤5: 执行搜索...
✓ 已点击: start_search_button.png
等待搜索完成（超时: 300秒）...
搜索已完成
步骤6: 提取搜索结果...
成功提取 5 条推荐号码
步骤7: 获取开奖数据并对比...
步骤8: 记录对比结果...
✅ 桌面自动化流程执行完成
```
